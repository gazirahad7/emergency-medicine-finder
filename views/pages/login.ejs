<%- include ('../template/header') %>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-8 offset-2 mt-4 card p-4">
                <% if(session.u_id) { %>
                    <div class="mb-3">
                        <figure class="text-center">
                            <p class="h3">Welcome
                                <%- session.first_name %>
                                    <%- session.last_name %>

                            </p>
                            <blockquote class="blockquote">
                                <p>
                                    You are a <%- session.role %>
                                </p>
                            </blockquote>
                            <figcaption class="blockquote-footer">
                                Use our system </figcaption>

                            <a href="/logout" class="btn btn-primary rounded-pill">Logout</a>
                        </figure>
                    </div>
                    <% } else { %>
                        <h4 class="mt-2">Login</h4>

                        <div class="mt-3 login-and-res">
                            <form action="/login" method="post">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="" class="form-label"><i class="las la-mobile"></i>
                                                Email:</label>
                                            <input type="email" class="form-control" name="email" required />
                                        </div>
                                        <div class="mb-3" hidden>
                                            <label for="" class="form-label"> Role:</label>
                                            <select class="form-select" id="role" name="role" aria-label="Default select example">
                                                <option selected required>Select Role :</option>
                                                <option value="user">User</option>
                                                <option value="shopkeeper">Shopkeeper</option>
                                                <option value="delivery">Delivery Man</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="" class="form-label"><i class="las la-mobile"></i>
                                                Password:</label>
                                            <input type="password" class="form-control" name="pass" required />
                                        </div>
                                        <button type="submit" class="btn btn-warning rounded-pill">Login</button>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <figure class="text-center">
                                                <p class="h3">Create a new account</p>
                                                <blockquote class="blockquote">
                                                    <p>For user The Emergency Medicine Finder.</p>
                                                </blockquote>
                                                <!-- <figcaption class="blockquote-footer">
                                                    You Create accoun as user or a delivery man</cite>
                                                </figcaption> -->
                                            </figure>
                                        </div>
                                        <div class="d-grid gap-2 col-6 mx-auto">
                                            <a href="/signup" class="btn btn-primary rounded-pill"
                                                type="button">SignUp!</a>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <script src="/JS/login.js"></script>
                        <% } %>
            </div>
        </div>
    </div>
    <%- include ('../template/footer') %>



    const divisionsList = document.querySelector('.divisions');
    const endPoint = "https://bdapis.herokuapp.com/api/v1.1/divisions";
    
    async function bdApi(url) {
      const res = await fetch(url)
      return res.json();
    }
    
    bdApi(endPoint)
      .then(divisions => {
        const allDivisions = divisions.data;
    
        allDivisions.forEach(division => {
          const li = document.createElement("option");
          li.textContent = division.division;
          const att = document.createAttribute("value");
          att.value = division.division;
          divisionsList.append(li);
        })
      })
      .catch(error => {
        console.error('Error::', error);
      });

    const districtList = document.querySelector('.districts');
    const endPoint2 = "https://bdapis.herokuapp.com/api/v1.1/districts/";
    
    async function bdApi(url) {
  const res = await fetch(url)
  return res.json();
}